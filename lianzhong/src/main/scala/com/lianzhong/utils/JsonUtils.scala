package com.lianzhong.utils

import com.alibaba.fastjson.{JSON, JSONArray, JSONObject}

import scala.collection.JavaConversions._
import scala.io.Source
import java.util.Map

object JsonUtils {

/*  def main(args: Array[String]) = {
    val datajson =
      """
        {"data":[{"APP_NO":"295158","APP_CODE":"L1811092100001952001","PROPPSER_ID":"283066","CAR_ID":"283102","DEALER_CODE":"20001381","DEALER_NAME":"耀武二手车行","COMPANY_NAME":"上海曌扬汽车服务有限公司（长沙直营）","IS_OLD":"1","IS_LCV":"1","SALE_PRICE":"78000.0","IS_GPS":"0","GPS_FEE":"1300.0","IS_GPS_LOAN":"1","A_CARLOAN_AMOUNT":"54600.0","A_LOAN_AMOUNT":"70100.0","A_INIT_PAYMENT":"23400.0","A_INIT_SCALE":"30.0","A_LOAN_PERIODS":"36","a_loan_rate":"7.1250","LOAN_RECORD":null,"APP_SCORE":null,"R_LOAN_AMOUNT":"69800.0","R_INIT_PAYMENT":"23700.0","R_INIT_SCALE":"30.38","R_LOAN_PERIODS":"36","r_loan_rate":"7.1250","REP_ACCOUNT_BANK":"建设银行","REP_ACCOUNT_NO":"6217002920149421258","REP_ACCOUNT_NAME":"宋争名","CREATE_TIME":"2018-11-09 13:33:24","APP_TIME":"2018-11-09 15:12:07","UPDATE_TIME":"2018-11-09 15:45:26","LOANER_APPROVAL_TIME":"2018-11-09 15:46:06","MANAGE_APPROVAL_TIME":"2018-11-09 15:50:29","BLOAN_DATA_TIME":null,"BLOAN_APPROVAL_TIME":null,"ALOAN_DATA_TIME":null,"ALOAN_APPROVAL_TIME":null,"LOAN_TIME":null,"ALOAN_ARRIVE":null,"CANCEL_TYPE":null,"CANCEL_REASON":null,"STATUS":"30","REMARKS":"客户一直在老家种庄稼为生，承包了三十亩地，年收入大概10万左右，是老实人家，麻烦老师审批!","IS_ASSURE":"0","COMPANY_CODE":"20001","user_id":"2100001952","user_name":"刘艳娥","FLOW_SEQ":"11","IS_DEFER_MORTGAGE":null,"PRODUCT_CODE":"61","PRODUCT_NAME":"联众极速贷","R_GPS_FEE":"1300.0","A_SECURE_FEE":"3800.0","R_SECURE_FEE":"3800.0","IS_PRINT_W":"0","IS_HOUSE":"0","LOAN_REMARKS":"重复信息无异常,手机本地,微信支付宝无异常,同盾无异常。身份信息核,紧1为姐姐,紧2为朋友,务农种烤烟草,三四十亩地,做了5/6年,年净收入:7/8年,车辆信息核,第一次购车,二手车主不认识,自己开,用途:家用,联系人知晓购车。","BLOAN_REMARKS":null,"SYSA_REMARKS":"L1811082110000091001:主贷人与重复主贷人现工作单位名称,\r\nL1811072110000091001:主贷人与重复主贷人现工作单位名称,\r\nL1811072110000017001:主贷人与重复主贷人现工作单位名称,\r\nL1811072100002412001:主贷人与重复主贷人现工作单位名称,主贷人与重复主贷人配偶现工作单位名称,\r\nL1811062110000091001:主贷人与重复主贷人现工作单位名称,\r\nL1811062100002309002:主贷人与重复主贷人现工作单位名称,\r\nL1811062100001833002:主贷人与重复主贷人现工作单位名称,\r\nL1811062100001196001:主贷人与重复主贷人现工作单位名称,\r\nL1811062100000692004:主贷人与重复主贷人现工作单位名称,\r\nL1811062100000487001:主贷人与重复主贷人现工作单位名称,\r\nL1811042100001761001:主贷人与重复主贷人现工作单位名称,\r\nL1811022100000308003:主贷人与重复主贷人现工作单位名称,\r\nL1811022100000229002:主贷人与重复主贷人现工作单位名称,\r\nL1811012100000854001:主贷人与","YY_RISK_REMARKS":null,"YY_PRE_RISK_REMARKS":null,"SYSA_DATE":"2018-11-09 15:12:07","SYSA_STATUS":"1","SYSA_RESULT":null,"REFUSE_STATUS":"2","IS_PREPAY":null,"PREPAY_DATE":null,"EXTRA_LOAN_AMOUNT":null,"PAYMENT_CH":null,"DATE_CH":null,"payment_ch_zn":null,"discount_e":null,"disa_rate":null,"discount_true_e":null,"r_discount_true_e":null,"FY_REMARKS":"联系人核工作无异常。Q54300","loan_status":null,"IS_CREDIT_REPORT":null,"model_ids":null,"A_COM_RATE":"10.50","A_COM_FEE":"5800.0","A_YANBAO_FEE":"500.0","A_YANBAO_TC":"10640","A_YANBAO_TC_NAME":"GPS责任险","R_COM_FEE":"5800.0","R_YANBAO_FEE":"500.0","CH_APPROVAL_STATUS":null,"PLED_MODEL_ID":"5","AUTH_CH":null,"payment_ch_en":null,"FILE_NUMBER":null,"POST_LOAN_STATUS":null,"LOAN_AFTER_REMARKS":null,"LOAN_AFTER_CONDITION":null,"IS_CREDIT":"0","RATE_LEVEL":"26","R_RATE_LEVEL":"26","ACCOUNT_FEE":"3800.0","R_ACCOUNT_FEE":"3800.0","R_CARLOAN_AMOUNT":"54300.0","LOAN_FILE_STATUS":null,"BELONG_DEALER":null,"BELONG_SALE":null,"BELONG_SALE_MANAGER":null,"BELONG_OPERATION":null,"BELONG_MARKET":null,"REP_ACCOUNT_IDNO":"430181197810013715","IS_CHECK_ACCOUNT":null,"GPS_LEVEL":"0","GPS_CONFIRM_DATE":null,"GPS_REBATE":"0.0","SER_FIN_REBATE":"0.0","come_from":"1","BELONG_SALE_TEL":null,"IS_PRE_INTEREST":"0","R_GROSS_INTEREST":null,"GROSS_INTEREST":null,"EXTEND_COST":null,"R_EXTEND_COST":null,"EXTEND_ID":null,"EXTEND_NAME":null,"PRE_LOAN_RATE":"7.13","first_submit":"2018-11-09 14:46:03","AUTO_APPR":"1","AUTO_APPR_TIME":null,"WORKFLOW_QUEUE":"B","BATCH_PAY_FLAG":null,"SEND_APPR":null,"YY_APPROVAL_RESULT":null,"IS_CERT_ALL":null,"is_auth_yh":null,"loan_after_yuan_remarks":null,"IS_VIP_CONTRACT":null,"is_quick_audit":null,"assign":null,"REP_ACCOUNT_MOBILE":"15111178398","credit_source":"2","is_merge":"0","is_change":null,"fund_type":"CMBC","partner_id":null,"app_type":"01","static_scale_type":null,"deposit_pay_type":null,"deposit_charge_type":null,"last_payment":null,"last_scale":null,"purchase_tax":null,"annual_fee":null,"deposit":null,"deposit_scale":null,"r_deposit":null,"is_register":null,"check_status":null,"check_back_reason":null,"service_fee":null,"r_service_fee":null,"market_fee":"300.0","dealer_fee":"61900.0","with_hold_fee":"7900.0","com_fee_actual":"0.0","is_limit_submit":null,"com_rule_seq":"174","fee_rate":null,"account_fee_actual":"3800.0","insurance_num":null,"is_send":null,"send_loan_amount":null,"credit_sign_method":"10660","gps_send_date":null,"old_app_code":null,"transfer_remarks":null,"third_loan_time":null,"third_loan_amount":null,"make_send":null}],"database":"lz_car","es":1541749829000,"id":414,"isDdl":false,"mysqlType":{"APP_NO":"int(11)","APP_CODE":"varchar(30)","PROPPSER_ID":"int(11)","CAR_ID":"int(11)","DEALER_CODE":"int(8)","DEALER_NAME":"varchar(80)","COMPANY_NAME":"varchar(80)","IS_OLD":"char(1)","IS_LCV":"char(1)","SALE_PRICE":"decimal(10,2)","IS_GPS":"char(1)","GPS_FEE":"decimal(10,2)","IS_GPS_LOAN":"char(1)","A_CARLOAN_AMOUNT":"decimal(10,2)","A_LOAN_AMOUNT":"decimal(10,2)","A_INIT_PAYMENT":"decimal(10,2)","A_INIT_SCALE":"decimal(5,2)","A_LOAN_PERIODS":"tinyint(4)","a_loan_rate":"decimal(10,4)","LOAN_RECORD":"char(2)","APP_SCORE":"decimal(5,2)","R_LOAN_AMOUNT":"decimal(10,2)","R_INIT_PAYMENT":"decimal(10,2)","R_INIT_SCALE":"decimal(5,2)","R_LOAN_PERIODS":"tinyint(4)","r_loan_rate":"decimal(10,4)","REP_ACCOUNT_BANK":"varchar(100)","REP_ACCOUNT_NO":"varchar(50)","REP_ACCOUNT_NAME":"varchar(50)","CREATE_TIME":"datetime","APP_TIME":"datetime","UPDATE_TIME":"timestamp","LOANER_APPROVAL_TIME":"datetime","MANAGE_APPROVAL_TIME":"datetime","BLOAN_DATA_TIME":"datetime","BLOAN_APPROVAL_TIME":"datetime","ALOAN_DATA_TIME":"datetime","ALOAN_APPROVAL_TIME":"datetime","LOAN_TIME":"datetime","ALOAN_ARRIVE":"varchar(20)","CANCEL_TYPE":"char(20)","CANCEL_REASON":"varchar(200)","STATUS":"char(2)","REMARKS":"varchar(1000)","IS_ASSURE":"char(1)","COMPANY_CODE":"int(11)","user_id":"int(11)","user_name":"varchar(20)","FLOW_SEQ":"int(11)","IS_DEFER_MORTGAGE":"varchar(1)","PRODUCT_CODE":"int(11)","PRODUCT_NAME":"varchar(100)","R_GPS_FEE":"decimal(10,2)","A_SECURE_FEE":"decimal(10,2)","R_SECURE_FEE":"decimal(10,2)","IS_PRINT_W":"char(1)","IS_HOUSE":"char(1)","LOAN_REMARKS":"varchar(1000)","BLOAN_REMARKS":"varchar(1000)","SYSA_REMARKS":"varchar(5000)","YY_RISK_REMARKS":"varchar(1000)","YY_PRE_RISK_REMARKS":"varchar(1000)","SYSA_DATE":"datetime","SYSA_STATUS":"char(2)","SYSA_RESULT":"char(1)","REFUSE_STATUS":"char(1)","IS_PREPAY":"char(1)","PREPAY_DATE":"datetime","EXTRA_LOAN_AMOUNT":"decimal(10,2)","PAYMENT_CH":"varchar(20)","DATE_CH":"datetime","payment_ch_zn":"varchar(30)","discount_e":"decimal(10,2)","disa_rate":"decimal(5,2)","discount_true_e":"decimal(10,2)","r_discount_true_e":"decimal(10,2)","FY_REMARKS":"varchar(1000)","loan_status":"varchar(2)","IS_CREDIT_REPORT":"char(1)","model_ids":"varchar(1024)","A_COM_RATE":"decimal(5,2)","A_COM_FEE":"decimal(10,2)","A_YANBAO_FEE":"decimal(10,2)","A_YANBAO_TC":"int(11)","A_YANBAO_TC_NAME":"varchar(100)","R_COM_FEE":"decimal(10,2)","R_YANBAO_FEE":"decimal(10,2)","CH_APPROVAL_STATUS":"varchar(100)","PLED_MODEL_ID":"varchar(100)","AUTH_CH":"varchar(100)","payment_ch_en":"varchar(50)","FILE_NUMBER":"varchar(20)","POST_LOAN_STATUS":"char(2)","LOAN_AFTER_REMARKS":"varchar(1000)","LOAN_AFTER_CONDITION":"varchar(20)","IS_CREDIT":"char(1)","RATE_LEVEL":"varchar(100)","R_RATE_LEVEL":"varchar(100)","ACCOUNT_FEE":"decimal(10,2)","R_ACCOUNT_FEE":"decimal(10,2)","R_CARLOAN_AMOUNT":"decimal(10,2)","LOAN_FILE_STATUS":"varchar(2)","BELONG_DEALER":"varchar(100)","BELONG_SALE":"varchar(30)","BELONG_SALE_MANAGER":"varchar(30)","BELONG_OPERATION":"varchar(30)","BELONG_MARKET":"varchar(100)","REP_ACCOUNT_IDNO":"varchar(50)","IS_CHECK_ACCOUNT":"char(1)","GPS_LEVEL":"varchar(10)","GPS_CONFIRM_DATE":"datetime","GPS_REBATE":"decimal(10,2)","SER_FIN_REBATE":"decimal(10,2)","come_from":"char(1)","BELONG_SALE_TEL":"varchar(30)","IS_PRE_INTEREST":"char(1)","R_GROSS_INTEREST":"decimal(10,2)","GROSS_INTEREST":"decimal(10,2)","EXTEND_COST":"decimal(10,2)","R_EXTEND_COST":"decimal(10,2)","EXTEND_ID":"varchar(10)","EXTEND_NAME":"varchar(30)","PRE_LOAN_RATE":"decimal(5,2)","first_submit":"datetime","AUTO_APPR":"varchar(20)","AUTO_APPR_TIME":"datetime","WORKFLOW_QUEUE":"varchar(30)","BATCH_PAY_FLAG":"varchar(10)","SEND_APPR":"varchar(2)","YY_APPROVAL_RESULT":"varchar(10)","IS_CERT_ALL":"char(1)","is_auth_yh":"char(1)","loan_after_yuan_remarks":"varchar(600)","IS_VIP_CONTRACT":"char(2)","is_quick_audit":"varchar(10)","assign":"char(1)","REP_ACCOUNT_MOBILE":"varchar(50)","credit_source":"char(2)","is_merge":"char(1)","is_change":"datetime","fund_type":"varchar(100)","partner_id":"varchar(100)","app_type":"varchar(10)","static_scale_type":"char(2)","deposit_pay_type":"char(2)","deposit_charge_type":"char(2)","last_payment":"decimal(10,2)","last_scale":"decimal(5,2)","purchase_tax":"decimal(10,2)","annual_fee":"decimal(10,2)","deposit":"decimal(10,2)","deposit_scale":"decimal(5,2)","r_deposit":"decimal(10,2)","is_register":"char(1)","check_status":"char(2)","check_back_reason":"varchar(200)","service_fee":"decimal(10,2)","r_service_fee":"decimal(10,2)","market_fee":"decimal(10,2)","dealer_fee":"decimal(10,2)","with_hold_fee":"decimal(10,2)","com_fee_actual":"decimal(10,2)","is_limit_submit":"char(2)","com_rule_seq":"int(11)","fee_rate":"decimal(10,2)","account_fee_actual":"decimal(10,2)","insurance_num":"varchar(100)","is_send":"char(1)","send_loan_amount":"decimal(10,2)","credit_sign_method":"varchar(10)","gps_send_date":"datetime","old_app_code":"varchar(255)","transfer_remarks":"varchar(100)","third_loan_time":"datetime","third_loan_amount":"decimal(10,2)","make_send":"char(1)"},"old":[{"MANAGE_APPROVAL_TIME":null,"CANCEL_TYPE":"有条件批复","CANCEL_REASON":"QA44,","STATUS":"24","REFUSE_STATUS":null,"make_send":"1"}],"sql":"","sqlType":{"APP_NO":4,"APP_CODE":12,"PROPPSER_ID":4,"CAR_ID":4,"DEALER_CODE":4,"DEALER_NAME":12,"COMPANY_NAME":12,"IS_OLD":1,"IS_LCV":1,"SALE_PRICE":3,"IS_GPS":1,"GPS_FEE":3,"IS_GPS_LOAN":1,"A_CARLOAN_AMOUNT":3,"A_LOAN_AMOUNT":3,"A_INIT_PAYMENT":3,"A_INIT_SCALE":3,"A_LOAN_PERIODS":-6,"a_loan_rate":3,"LOAN_RECORD":1,"APP_SCORE":3,"R_LOAN_AMOUNT":3,"R_INIT_PAYMENT":3,"R_INIT_SCALE":3,"R_LOAN_PERIODS":-6,"r_loan_rate":3,"REP_ACCOUNT_BANK":12,"REP_ACCOUNT_NO":12,"REP_ACCOUNT_NAME":12,"CREATE_TIME":93,"APP_TIME":93,"UPDATE_TIME":93,"LOANER_APPROVAL_TIME":93,"MANAGE_APPROVAL_TIME":93,"BLOAN_DATA_TIME":93,"BLOAN_APPROVAL_TIME":93,"ALOAN_DATA_TIME":93,"ALOAN_APPROVAL_TIME":93,"LOAN_TIME":93,"ALOAN_ARRIVE":12,"CANCEL_TYPE":1,"CANCEL_REASON":12,"STATUS":1,"REMARKS":12,"IS_ASSURE":1,"COMPANY_CODE":4,"user_id":4,"user_name":12,"FLOW_SEQ":4,"IS_DEFER_MORTGAGE":12,"PRODUCT_CODE":4,"PRODUCT_NAME":12,"R_GPS_FEE":3,"A_SECURE_FEE":3,"R_SECURE_FEE":3,"IS_PRINT_W":1,"IS_HOUSE":1,"LOAN_REMARKS":12,"BLOAN_REMARKS":12,"SYSA_REMARKS":12,"YY_RISK_REMARKS":12,"YY_PRE_RISK_REMARKS":12,"SYSA_DATE":93,"SYSA_STATUS":1,"SYSA_RESULT":1,"REFUSE_STATUS":1,"IS_PREPAY":1,"PREPAY_DATE":93,"EXTRA_LOAN_AMOUNT":3,"PAYMENT_CH":12,"DATE_CH":93,"payment_ch_zn":12,"discount_e":3,"disa_rate":3,"discount_true_e":3,"r_discount_true_e":3,"FY_REMARKS":12,"loan_status":12,"IS_CREDIT_REPORT":1,"model_ids":12,"A_COM_RATE":3,"A_COM_FEE":3,"A_YANBAO_FEE":3,"A_YANBAO_TC":4,"A_YANBAO_TC_NAME":12,"R_COM_FEE":3,"R_YANBAO_FEE":3,"CH_APPROVAL_STATUS":12,"PLED_MODEL_ID":12,"AUTH_CH":12,"payment_ch_en":12,"FILE_NUMBER":12,"POST_LOAN_STATUS":1,"LOAN_AFTER_REMARKS":12,"LOAN_AFTER_CONDITION":12,"IS_CREDIT":1,"RATE_LEVEL":12,"R_RATE_LEVEL":12,"ACCOUNT_FEE":3,"R_ACCOUNT_FEE":3,"R_CARLOAN_AMOUNT":3,"LOAN_FILE_STATUS":12,"BELONG_DEALER":12,"BELONG_SALE":12,"BELONG_SALE_MANAGER":12,"BELONG_OPERATION":12,"BELONG_MARKET":12,"REP_ACCOUNT_IDNO":12,"IS_CHECK_ACCOUNT":1,"GPS_LEVEL":12,"GPS_CONFIRM_DATE":93,"GPS_REBATE":3,"SER_FIN_REBATE":3,"come_from":1,"BELONG_SALE_TEL":12,"IS_PRE_INTEREST":1,"R_GROSS_INTEREST":3,"GROSS_INTEREST":3,"EXTEND_COST":3,"R_EXTEND_COST":3,"EXTEND_ID":12,"EXTEND_NAME":12,"PRE_LOAN_RATE":3,"first_submit":93,"AUTO_APPR":12,"AUTO_APPR_TIME":93,"WORKFLOW_QUEUE":12,"BATCH_PAY_FLAG":12,"SEND_APPR":12,"YY_APPROVAL_RESULT":12,"IS_CERT_ALL":1,"is_auth_yh":1,"loan_after_yuan_remarks":12,"IS_VIP_CONTRACT":1,"is_quick_audit":12,"assign":1,"REP_ACCOUNT_MOBILE":12,"credit_source":1,"is_merge":1,"is_change":93,"fund_type":12,"partner_id":12,"app_type":12,"static_scale_type":1,"deposit_pay_type":1,"deposit_charge_type":1,"last_payment":3,"last_scale":3,"purchase_tax":3,"annual_fee":3,"deposit":3,"deposit_scale":3,"r_deposit":3,"is_register":1,"check_status":1,"check_back_reason":12,"service_fee":3,"r_service_fee":3,"market_fee":3,"dealer_fee":3,"with_hold_fee":3,"com_fee_actual":3,"is_limit_submit":1,"com_rule_seq":4,"fee_rate":3,"account_fee_actual":3,"insurance_num":12,"is_send":1,"send_loan_amount":3,"credit_sign_method":12,"gps_send_date":93,"old_app_code":12,"transfer_remarks":12,"third_loan_time":93,"third_loan_amount":3,"make_send":1},"table":"ca_app_info","ts":1541749829177,"type":"UPDATE"}
      """.stripMargin
    val map: Map[String,Object] = JSON.parseObject(datajson,classOf[Map[String,Object]])
    val eventType = map.get("type")
    println(eventType)
    val data = map.get("data").toString.replace("[","").replace("]","")
    val dbdata: Map[String,String] =  JSON.parseObject(data,classOf[Map[String,String]])
    val appcode = dbdata.get("APP_CODE")
    val first_submit = dbdata.get("first_submit")
    val fknum = 30
    val fkamount = 30
    val LOAN_TIME = dbdata.get("LOAN_TIME")
    val status = dbdata.get("STATUS")
    println(status)
    println("LOAN_TIME===>" + LOAN_TIME)


    println("APP_CODE===>" + appcode)
/*    dbdata.foreach{m=>
      println(m._1 + "--->" + m._2)
    }*/
  }*/

  def fromFile2Text(path: String): String = {
    Source.fromFile(path).mkString
  }

  /**
    * 将文本转为JSON对象
    * @param text
    * @return JSONObject
    */
    def parseObject(text: String): JSONObject = {
      JSON.parseObject(text)
    }

  def json2Map(text: String): Map[String,Object] = {
    JSON.parseObject(text, classOf[Map[String,Object]])
  }

  def data2Map(datajson: String): Map[String,String] = {
    val map: Map[String,Object] = JSON.parseObject(datajson,classOf[Map[String,Object]])
    val data = map.get("data").toString.replace("[","").replace("]","")
    JSON.parseObject(data,classOf[Map[String,String]])
  }
}